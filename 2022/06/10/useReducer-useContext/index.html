<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>useReducer+useContext | Never</title>
  <meta name="description" content="学习的文章The best Couple: useContext + useReducer !Disclaimer: This is going to be one of the best post you have ever come across in search of useContext + useReducer hooks! Why do we use useContext and u">
<meta property="og:type" content="article">
<meta property="og:title" content="useReducer+useContext">
<meta property="og:url" content="http://nevvvver.github.io/2022/06/10/useReducer-useContext/index.html">
<meta property="og:site_name" content="Never">
<meta property="og:description" content="学习的文章The best Couple: useContext + useReducer !Disclaimer: This is going to be one of the best post you have ever come across in search of useContext + useReducer hooks! Why do we use useContext and u">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--_X6fGzNV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/kwmuw3qj5jz3wcwix1u4.JPG">
<meta property="og:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--bVItofqA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/tn1hhnrzxrxn7yth8o8f.JPG">
<meta property="og:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--MqBG--ZV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/e7o0vyc66tmskxahlhia.JPG">
<meta property="og:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--mXRokjIr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/hcqdw4lt6s2q07xn3no5.JPG">
<meta property="og:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--mTRB9Re3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/ccjg9mco1cw4wtxqkmkx.JPG">
<meta property="og:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--OcAWI3v4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/z355nnwd7rl9bypg2qzg.JPG">
<meta property="article:published_time" content="2022-06-10T03:08:02.000Z">
<meta property="article:modified_time" content="2022-07-11T09:21:40.867Z">
<meta property="article:author" content="Never">
<meta property="article:tag" content="react">
<meta property="article:tag" content="context">
<meta property="article:tag" content="reducer">
<meta property="article:tag" content="hooks">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://res.cloudinary.com/practicaldev/image/fetch/s--_X6fGzNV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/kwmuw3qj5jz3wcwix1u4.JPG">
  <!-- Canonical links -->
  <link rel="canonical" href="http://nevvvver.github.io/2022/06/10/useReducer-useContext/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Never" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.jpg" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 6.2.0"></head>


<script src="/js/hexo_resize_image.js"></script>
<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/Nevvvver" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Never</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Web Developer &amp; Sunday painter</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shanghai, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Nevvvver" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/null" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/null" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Books/">Books</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TypeScript/">TypeScript</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/context/" rel="tag">context</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/" rel="tag">es6</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hooks/" rel="tag">hooks</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/" rel="tag">node</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reducer/" rel="tag">reducer</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/context/" style="font-size: 13px;">context</a> <a href="/tags/es6/" style="font-size: 13.5px;">es6</a> <a href="/tags/hooks/" style="font-size: 13px;">hooks</a> <a href="/tags/javascript/" style="font-size: 14px;">javascript</a> <a href="/tags/node/" style="font-size: 13px;">node</a> <a href="/tags/react/" style="font-size: 13px;">react</a> <a href="/tags/reducer/" style="font-size: 13px;">reducer</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2022/07/18/hexo%E4%B8%AD%E6%8E%A5%E5%85%A5chatwoot%E5%AE%9E%E6%97%B6%E8%81%8A%E5%A4%A9/" class="title">hexo中接入chatwoot实时聊天</a>
              </p>
              <p class="item-date">
                <time datetime="2022-07-18T07:58:35.000Z" itemprop="datePublished">2022-07-18</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Books/">Books</a>
              </p>
              <p class="item-title">
                <a href="/2022/07/13/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANodeJS/" class="title">《深入浅出Node.js》笔记</a>
              </p>
              <p class="item-date">
                <time datetime="2022-07-13T09:35:49.000Z" itemprop="datePublished">2022-07-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Books/">Books</a>
              </p>
              <p class="item-title">
                <a href="/2022/07/11/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97/" class="title">《JavaScript权威指南(第6版)》笔记</a>
              </p>
              <p class="item-date">
                <time datetime="2022-07-11T09:27:54.000Z" itemprop="datePublished">2022-07-11</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/React/">React</a>
              </p>
              <p class="item-title">
                <a href="/2022/06/10/useReducer-useContext/" class="title">useReducer+useContext</a>
              </p>
              <p class="item-date">
                <time datetime="2022-06-10T03:08:02.000Z" itemprop="datePublished">2022-06-10</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/TypeScript/">TypeScript</a>
              </p>
              <p class="item-title">
                <a href="/2022/06/07/jsoneditor-react%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6/" class="title">jsoneditor-react的类型声明文件</a>
              </p>
              <p class="item-date">
                <time datetime="2022-06-07T09:25:44.000Z" itemprop="datePublished">2022-06-07</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%96%87%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text">学习的文章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">我的应用</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-useReducer-useContext" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      useReducer+useContext
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2022/06/10/useReducer-useContext/" class="article-date">
	  <time datetime="2022-06-10T03:08:02.000Z" itemprop="datePublished">2022-06-10</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/React/">React</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/context/" rel="tag">context</a>, <a class="article-tag-link-link" href="/tags/hooks/" rel="tag">hooks</a>, <a class="article-tag-link-link" href="/tags/react/" rel="tag">react</a>, <a class="article-tag-link-link" href="/tags/reducer/" rel="tag">reducer</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2022/06/10/useReducer-useContext/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h3 id="学习的文章"><a href="#学习的文章" class="headerlink" title="学习的文章"></a>学习的文章</h3><p><a target="_blank" rel="noopener" href="https://dev.to/jackent2b/the-best-couple-usecontext-usereducer-4e65">The best Couple: useContext + useReducer !</a><br>Disclaimer:</p>
<p>This is going to be one of the best post you have ever come across in search of useContext + useReducer hooks!</p>
<p>Why do we use useContext and usereducer together?</p>
<p>Reason: To share states between the components i.e. Global State<br>Management</p>
<p>In the previous posts, we have seen how to make use of useContext and useReducer hooks.</p>
<p>So, in this post, we will see how to make use of them together!<br><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--_X6fGzNV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/kwmuw3qj5jz3wcwix1u4.JPG"></p>
<p>In this example, we are going to share the state of the counter between Component A , Component D and Component F!</p>
<p>Also, the Components hierarchy in our example is as follows:</p>
<p>1.)Component A<br>2.)Component B -&gt; Component D<br>3.)Component C -&gt; Component E -&gt; Component F</p>
<p>Steps:</p>
<p>1.) Create React context in the main component</p>
<p>2.) Make reducer function in the main component</p>
<p>3.) Make use of the useReducer function.</p>
<p>4.) Send context value using Context Provider</p>
<p>5.) Consume Context Value using useContext hook.</p>
<p>6.) Transfer action from the components using dispatch</p>
<p>Okay so let’s get started!</p>
<p>Step1: Create React Context and reducer() function:<br><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--bVItofqA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/tn1hhnrzxrxn7yth8o8f.JPG" alt="step1"></p>
<p>Step2: In the functional component, call useReducer(reducer,initialState) hook :</p>
<p><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--MqBG--ZV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/e7o0vyc66tmskxahlhia.JPG"></p>
<p>Here, you can see that we have passed the state i.e. counter and dispatch method as the value in the Context Provider.</p>
<p>Step 3: Now, in order to access the global state in Component A, Component D, and Component F, we need to make use of the useContext Hook to consume the context value passed by the Context Provider.</p>
<p>(component A)<br><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--mXRokjIr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/hcqdw4lt6s2q07xn3no5.JPG"><br>(component D)<br><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--mTRB9Re3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/ccjg9mco1cw4wtxqkmkx.JPG"></p>
<p>(component F)<br><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--OcAWI3v4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https%3A//dev-to-uploads.s3.amazonaws.com/i/z355nnwd7rl9bypg2qzg.JPG"></p>
<p>Step 4: In order to change the global state through Components A, D, and F, we have passed action (i.e. increment, decrement, or reset) through the dispatch function.</p>
<p>This is all you need to manage the global state using useReducer and useContext hook!</p>
<p>I hope it might have helped you!</p>
<p>Do share your thaughts!</p>
<p>*Happy Coding, Thank you! *</p>
<p>-Jayant Khandelwal</p>
<h3 id="我的应用"><a href="#我的应用" class="headerlink" title="我的应用"></a>我的应用</h3><p>背景<br>一个多tab选规则的面板 每个tab下面的规则不一样（规则一样，选的值可以不一样）</p>
<p>但是都是渲染的一个面板 只是切换tab的时候从store里拿不一样的value填进去<br>此时有一个规则组件有校验的问题 只能存在本地  但是state存储无法存储不同tab的校验状态</p>
<p>所以此时用一个本地的对象来存 以每个tab规则的id来作为索引存每一个规则的校验状态<br>比如规则1 是校验失败 规则2是校验成功<br>这个状态是存在state的无法 如果不专门存在store里是无法区分每个规则的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//rule-context.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Dispatch</span>, useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> type <span class="title class_">RuleProps</span> = &#123;</span><br><span class="line">   <span class="attr">helpState</span>: <span class="title class_">Record</span>&lt;string, <span class="title class_">Record</span>&lt;string, string&gt;&gt;;</span><br><span class="line">   <span class="attr">helpDispatch</span>: <span class="title class_">Dispatch</span>&lt;&#123; <span class="attr">type</span>: string; <span class="attr">payload</span>: &#123; <span class="attr">id</span>: string;<span class="attr">code</span>: string; <span class="attr">help</span>: string; flag?: string &#125; &#125;&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MdContext</span> = <span class="title class_">React</span>.<span class="property">createContext</span>&lt;<span class="title class_">RuleProps</span>&gt;(&#123;</span><br><span class="line">  <span class="attr">helpState</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">helpDispatch</span>: <span class="function">() =&gt;</span> <span class="keyword">void</span> <span class="number">0</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state: Record&lt;string, Record&lt;string, string&gt;&gt;, action: &#123;</span></span><br><span class="line"><span class="params">  type: string;</span></span><br><span class="line"><span class="params">  payload: &#123;</span></span><br><span class="line"><span class="params">    id: string;</span></span><br><span class="line"><span class="params">    code: string;</span></span><br><span class="line"><span class="params">    help: string;</span></span><br><span class="line"><span class="params">    flag?: string;</span></span><br><span class="line"><span class="params">  &#125;;</span></span><br><span class="line"><span class="params">&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;add&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        [action.<span class="property">payload</span>.<span class="property">id</span>]: &#123;</span><br><span class="line">          ...state[action.<span class="property">payload</span>.<span class="property">id</span>],</span><br><span class="line">          [action.<span class="property">payload</span>.<span class="property">code</span>]: action.<span class="property">payload</span>.<span class="property">help</span>,</span><br><span class="line">          [<span class="string">`<span class="subst">$&#123;action.payload.code&#125;</span>Flag`</span>]: action.<span class="property">payload</span>.<span class="property">flag</span> <span class="keyword">as</span> string,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useHelpRuleReducer</span> = (<span class="params"></span>) =&gt; <span class="title function_">useReducer</span>(reducer, &#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="title class_">MdContext</span>, useHelpRuleReducer &#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">//rule.tsx</span><br><span class="line">import &#123; MdContext &#125; from &#x27;rule-context.tsx&#x27;;</span><br><span class="line">const &#123; helpState, helpDispatch &#125; = useContext(MdContext);</span><br><span class="line"></span><br><span class="line">//使用</span><br><span class="line">helpDispatch(&#123;</span><br><span class="line">          type: &#x27;add&#x27;,</span><br><span class="line">          payload: &#123;</span><br><span class="line">            code,</span><br><span class="line">            id,</span><br><span class="line">            help: &#x27;校验失败&#x27;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">console.log(helpState[id]?.[code])</span><br></pre></td></tr></table></figure>


      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://nevvvver.github.io/2022/06/10/useReducer-useContext/" title="useReducer+useContext" target="_blank" rel="external">http://nevvvver.github.io/2022/06/10/useReducer-useContext/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/Nevvvver" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/Nevvvver" target="_blank"><span class="text-dark">Never</span><small class="ml-1x">Web Developer &amp; Sunday painter</small></a></h3>
        <div>Never worried, Never mind.</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2022/07/11/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97/" title="《JavaScript权威指南(第6版)》笔记"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2022/06/07/jsoneditor-react%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6/" title="jsoneditor-react的类型声明文件"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">    <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Nevvvver" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/null" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/null" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'Ptdp2i9mmWrGF9nq9nbtpgIG-gzGzoHsz',
    appKey: '7wtwhNMvPTwOwiqlYYsJzCTm',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     










  <script>
    (function(d, w, c) {
      w.ChatraID = 'FaTbsFnnNTkNfR62N';
      var s = d.createElement('script');
      w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
      };
      s.async = true;
      s.src = 'https://call.chatra.io/chatra.js';
      if (d.head) d.head.appendChild(s);
    })(document, window, 'Chatra');
  </script>
 

</body>
</html>